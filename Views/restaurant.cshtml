@using Umbraco.Cms.Web.Common.PublishedModels
@using umbraco_assignment.Models.ViewModels
@inherits UmbracoViewPage<RestaurantPageViewModel>

@{
    Layout = "root.cshtml";
    var imageUrls = Model.Content.Images?.Select(image => image.Url()).ToList() ?? new List<string>();
    var mainImageUrl = imageUrls.FirstOrDefault(); // För att visa första bilden som huvudbild initialt
}

<div class="container mt-4">
    <div class="row">
        <!-- Bildsektion -->
        <div class="col-lg-6 col-md-12 text-center mb-3">
            <div class="main-image-wrapper position-relative mx-auto">
                <!-- Stora huvudbilden med vänster och höger pilar -->
                <button class="btn test position-absolute top-50 start-0 translate-middle-y nav-button" onclick="prevImage()">&#10094;</button>
                <img id="mainImage" src="@mainImageUrl" alt="@Model.Content.RestaurantName" class="main-image img-fluid rounded border" />
                <button class="btn test position-absolute top-50 end-0 translate-middle-y nav-button" onclick="nextImage()">&#10095;</button>
            </div>

            <!-- Små miniatyrbilder under huvudbilden -->
            <div class="thumbnail-container d-flex justify-content-center gap-2 flex-wrap mt-2">
                @foreach (var imageUrl in imageUrls)
                {
                    <img src="@imageUrl" alt="@Model.Content.RestaurantName" class="thumbnail rounded border" onclick="changeMainImage('@imageUrl')" />
                }
            </div>
        </div>

        <!-- Textsektion -->
        <div class="col-lg-6 col-md-12">
            <h1 class="restaurant-name">@Model.Content.RestaurantName</h1>
            <p class="restaurant-description">@Model.Content.Description</p>
        </div>
    </div>
</div>

<script>
    // Array med bild-URL:er och aktuell bildindex
    const imageUrls = @Html.Raw(Newtonsoft.Json.JsonConvert.SerializeObject(imageUrls));
    let currentIndex = 0;

    function changeMainImage(imageUrl) {
        document.getElementById("mainImage").src = imageUrl;
        currentIndex = imageUrls.indexOf(imageUrl); // Uppdatera aktuell bildindex
    }

    function nextImage() {
        currentIndex = (currentIndex + 1) % imageUrls.length; // Öka index och loopa runt
        document.getElementById("mainImage").src = imageUrls[currentIndex];
    }

    function prevImage() {
        currentIndex = (currentIndex - 1 + imageUrls.length) % imageUrls.length; // Minska index och loopa runt
        document.getElementById("mainImage").src = imageUrls[currentIndex];
    }
</script>

<style>
    .row {
        margin-top: 76px;
    }

    .container {
        max-width: 1200px;
    }

    .main-image-wrapper {
        max-width: 525px;
    }

    .main-image {
        width: 100%;
        height: 400px; /* Fast höjd för huvudbild */
        object-fit: cover;
        border-radius: 5px;
    }

    .nav-button {
        padding: 8px;
        font-size: 24px;
        border-radius: 5px;
    }

    .btn {
        background: rgba(0, 0, 0, 0.4);
        color: #fff;
    }

    .btn:hover{
            background: rgba(0, 0, 0, 0.6);
            color: #fff;
    }

    .restaurant-name {
        margin: -8px 0 20px;
        font-size: 4rem;
        font-weight: bold;
        text-align: left;
        font-weight: 100;
        font-family: League Gothic;
    }

    .restaurant-description {
        font-weight: bold;
        text-align: left;
        font-weight: 100;
        font-size: 20px;
    }

    .thumbnail-container {
        margin-top: 10px;
    }

    .thumbnail {
        width: 80px;
        height: 80px;
        object-fit: cover;
        cursor: pointer;
        transition: transform 0.2s;
    }

        .thumbnail:hover {
            transform: scale(1.1);
        }

</style>